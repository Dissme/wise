<template id="bg">
	<style>
		.bg {
			height: 100%;
			width: 100%;
			overflow: hidden;
			position: relative;
			transition: all 0.2s ease;
			transform: translate(0, 0);
		}
		.bg canvas{
			width: 100%!important;
		}
	</style>
	<div class="bg" id="bg">
	</div>
	<script>
	~function(){
		var camera, scene, renderer,
		light1, light2, light3,
		loader, mesh, time = 0;
		var req = (function(){
                return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(cb){setTimeout(cb, 160)}
            })();
		init();
		animate();
		function init() {
			var container = document.getElementById( 'bg' );
			camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 1000 );
			camera.position.set( 0, - 6, 60 );
			scene = new THREE.Scene();
			scene.add( new THREE.AmbientLight( 0x000000 ) );
			light1 = new THREE.PointLight( 0x30a2ff, 1, 150 );
			scene.add( light1 );
			light2 = new THREE.PointLight( 0xf77478, 1, 150 );
			scene.add( light2 );
			light3 = new THREE.PointLight( 0xf4a236, 1, 150 );
			scene.add( light3 );
			light4 = new THREE.PointLight( 0xde57b4, 1, 150 );
			scene.add( light4 );
			var PI2 = Math.PI * 2;
			var program = function ( context ) {
				context.beginPath();
				context.arc( 0, 0, 0.5, 0, PI2, true );
				context.fill();
			};
			var sprite1 = new THREE.Sprite( new THREE.SpriteCanvasMaterial( { color: 0x004cff, program: program } ) );
			light1.add( sprite1 );
			var sprite2 = new THREE.Sprite( new THREE.SpriteCanvasMaterial( { color: 0xbd1a1a, program: program } ) );
			light2.add( sprite2 );
			var sprite3 = new THREE.Sprite( new THREE.SpriteCanvasMaterial( { color: 0xed6b00, program: program } ) );
			light3.add( sprite3 );
			var sprite4 = new THREE.Sprite( new THREE.SpriteCanvasMaterial( { color: 0x67006b, program: program } ) );
			light4.add( sprite4 );
			mesh = new THREE.Mesh()
			loader = new THREE.JSONLoader();
			loader.load( '{{root}}/data/WaltHeadLo.js', function ( geometry ) {
				mesh = new THREE.Mesh( geometry, new THREE.MeshLambertMaterial( { color: 0xffffff, overdraw: 0.5 } ) );
				scene.add( mesh );
			} );
			renderer = new THREE.CanvasRenderer();
			renderer.setPixelRatio( window.devicePixelRatio );
			renderer.setSize( window.innerWidth, window.innerHeight );
			container.appendChild( renderer.domElement );
			//
			window.addEventListener( 'resize', onWindowResize, false );
		}
		function onWindowResize() {
			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();
			renderer.setSize( window.innerWidth, window.innerHeight );
		}
		//
		function animate() {
			req( animate );
			render();
		}
		function render() {
			time += 0.01;
			if ( mesh ) {
				mesh.position.z = 20;
				mesh.rotation.y = 3;
				mesh.rotation.z = 3;
			}

			light1.position.x = Math.sin( time ) * 300;
			light1.position.y = Math.cos( time ) * 300;
			light1.position.z = Math.sin( time ) * 300;

			light2.position.x = Math.sin( time + Math.PI / 2 ) * 300;
			light2.position.y = Math.cos( time + Math.PI / 2 ) * 300;
			light2.position.z = Math.sin( time + Math.PI / 2 ) * 300;

			light3.position.x = Math.sin( time + Math.PI * 1.5 ) * 300;
			light3.position.y = Math.cos( time + Math.PI * 1.5 ) * 300;
			light3.position.z = Math.sin( time + Math.PI * 1.5 ) * 300;

			light4.position.x = Math.sin( time + Math.PI ) * 300;
			light4.position.y = Math.cos( time + Math.PI ) * 300;
			light4.position.z = Math.sin( time + Math.PI ) * 300;
			renderer.render( scene, camera );
		}
	}()
	</script>
</template>
<template id="entries">
	<style>
		.entries {
				width: 100%;
				color: white;
				text-align: center;
				white-space: nowrap;
				margin-top: 30px;
				font-size: 0.8em;
			}
			
			.entries a img {
				display: inline-block;
				height: 20px;
				margin: 5px;
				margin-top: 5px;
				margin-bottom: 8px;
			}
			
			.entries a span {
				font-weight: 300;
				display: block;
				color: white;
			}
			
			.entries a {
				width: 22%;
				display: inline-block;
				text-decoration: none;
				text-align: center;
				color: white;
			}
	</style>
	<div class="entries">
		<a href="{{root}}/?q=日程">
			<img src="{{root}}/assets/calendar.png" />
			<span>议程安排</span>
		</a>
		<a href="{{root}}/?q=场景搜索">
			<img src="{{root}}/assets/scene.png" style="transform:translateY(1.5px) scale(1.2);" />
			<span>场景搜索</span>
		</a href="#">
		<a href="http://36kr.com/topics/117" target="_blank">
			<img src="{{root}}/assets/news.png" style="scale(0.95);" />
			<span>动点新闻</span>
		</a>
		<a href="{{root}}/?q=关于">
			<img src="{{root}}/assets/tc.png" />
			<span>关于WISE</span>
		</a>
	</div>
</template>

<template id="searchbar">
	<style>
		.searchbar {
			height: 45px;
			position: relative;
			width: 100%;
			top: 5px;
			margin-bottom: 10px;
		}
		
		.searchbar > .rbox {
			margin-left: 1rem;
			margin-right: 1rem;
			width: auto;
			outline: none;
			border: 1px solid rgba(15, 104, 255, .3);
		}
		
		.searchbar > .rbox > div:nth-of-type(1) {
			height: 45px;
			width: 45px;
			position: absolute;
			right: 0;
			top: 0;
			background: #0f68ff;
			background-image: url("{{root}}/assets/search.png");
			background-size: 20px 20px;
			background-position: 50% 50%;
			background-repeat: no-repeat;
		}
		
		.searchbar input {
			width: 100%;
			height: 100%;
			outline: none;
			padding: 2px 70px 1px 7px;
			font-size: 1.2em;
			border-radius: 0;
			border: none;
			background: rgba(255, 255, 255, 0.6);
			transition: background 0.8s ease;
		}
		
		.searchbar input:focus {
			background: rgba(255, 255, 255, 1);
		}
		
		.searchbar .sug {
			position: absolute;
			left: 0;
			right: 0;
			top: 100%;
			z-index: 9999;
			display: none;
		}
		
		.searchbar .sug.focus {
			display: block;
		}
		
		.searchbar .sug a {
			height: 35px;
			display: block;
			border-top: 1px solid #eee;
			background: white;
			color: #999;
			line-height: 38px;
			text-align: left;
			font-size: 0.9em;
			text-overflow: ellipsis;
			overflow: hidden;
			padding-left: 10px;
			padding-right: 10px;
			white-space: nowrap;
			text-decoration: none;
		}
		
		.searchbar .sug a i {
			margin-right: 5px;
		}
		
		.searchbar .sug a:visited {
			color: #999;
		}
	</style>
	<div class="searchbar">
		<div class="rbox">
			<input type="text"></input>
			<div id='searchbtn'></div>
			<div class='sug'>

				<a href="test">某某某人的某某</a>
				<a href="test">某某某人的某某</a>
				<a href="test">某某某人的某某</a>
				<a href="test">某某某人的某某</a>
			</div>
		</div>
	</div>

	<script>
        var search_container = document.querySelector(".searchbar");
        var search_element = document.querySelector(".searchbar input");
        var search_btn = document.querySelector("#searchbtn");
        var search_sug = document.querySelector(".searchbar .sug");
        search_element.addEventListener("focus", function(){
            search_container.classList.add("focus") 
            search_sug.classList.add("focus");
        });
        search_element.addEventListener("blur", function(e){
            setTimeout(function(){
            search_sug.classList.remove("focus");
            search_container.classList.remove("focus") 
            }, 1);
        });
        search_element.addEventListener("keydown", function(e){
            if(e.keyCode == 13) window.location.href = ("{{root}}/?q=" + encodeURIComponent(search_element.value));
        });

        search_btn.addEventListener("click", function(e){
            window.location.href = ("{{root}}/?q=" + encodeURIComponent(search_element.value));
        });

        if(window.word) {
            search_element.value = window.word;
        }
        
    </script>
</template>

<template id="search_sug">
	<a href="{{root}}/?q={{keyword}}"><i class="fa fa-{{icon}}"></i> {{text}}</a>
</template>

<template id="poweredBy">
	<style>
		.poweredBy {
			text-align: center;
			display: block;
			line-height: 13px;
			font-size: 12px;
			padding: 30px;
			vertical-align: middle;
		}
		
		.poweredBy * {
			vertical-align: middle;
		}
		
		.poweredBy img {
			height: 9px;
			margin-left: 7px;
		}
	</style>
	<div class="poweredBy">
		<span>Powered By</span><img src="{{root}}/assets/{{em}}.png" />
	</div>
</template>